1 какие базовые цепочки и таблицы существуют в iptables и для чего служат?
```
Цепочки:

PREROUTING – позволяет модифицировать пакет до принятия решения о маршрутизации.

INPUT – позволяет модифицировать пакет, предназначенный самому хосту.

FORWARD – цепочка, позволяющая модифицировать транзитные пакеты.

OUTPUT – позволяет модифицировать пакеты, исходящие от самого хоста.

POSTROUTING – дает возможность модифицировать все исходящие пакеты,
как сгенерированные самим хостом, так и транзитные.


Таблицы:
raw – предназначена для обработки пакетов прежде, чем они будут переданы системе conntrack,
которая занимается отслеживанием состояния соединений и принадлежностью пакетов этим соединениям.
Содержит встроенные цепочки PREROUTING и OUTPUT.

mangle – используется для модификации некоторых заголовков (TTL, TOS) и маркировки
пакетов и соединений, содержит цепочки PREROUTING, INPUT, FORWARD, OUTPUT и POSTROUTING.

nat – предназначена для преобразования адресов и портов источника и назначения пакетов,
встроенные цепочки: PREROUTING, OUTPUT, POSTROUTING.

filter – применяется, собственно, для фильтрации пакетов, является таблицей по умолчанию,
т.е. если таблица не указана явно, то используется filter, имеет цепочки INPUT, FORWARD и OUTPUT.

security – используется для работы совместно с системами принудительного контроля доступа,
такими как SELinux. Встроенные цепочки INPUT, FORWARD, OUTPUT
```
2 опишите процесс обработки пакета который предназначен данной системе
```
Пакет пройдёт по пути:
PREROUTING -> INPUT -> Local Process -> OUTPUT -> POSTROUTING
```
3 что такое conntrack и для чего используется?
```
Conntrack – компонент, позволяющий ядру отслеживать все логические сетевые соединения или потоки,
тем самым идентифицировать все пакеты, которые составляют каждый поток, чтобы их можно было последовательно
обрабатывать вместе.
```
4 какими командами создать/удалить цепочку? создать/удалить правило? создать правило до определенного правила в цепочке?
```
Создать цепочку:
iptables -N CHAINNEW

Удалить цепочку:
iptables -X CHAINNEW

Создать правило:
iptables -A CHAIN -s 192.168.0.1 -j ACTION

Удалить правило:
iptables -D CHAIN

Создать правило до определённого правила в цепочке:
iptables -I CHAIN 5 -s 192.168.0.1 -j ACTION
```
***
***Лабораторная работа:***
взять за основу конфигурационный файл iptables и поднять в системе ssh сервер.
***
```
Поднят ssh сервер:
iptables-restore chelgu_iptables
systemctl start ssh
```
***
1 настроить правила которые разрешают доступ на этот сервер с определенной подсети или хоста в которой находитесь вы как клиент, продемонстрировать что работает icmp
***
```
iptables -I INPUT -s 192.168.11.1 -j ACCEPT
```
![dem1](dem1.PNG?raw=true)
***
2 затем закрыть доступ из этой подсети по icmp, осавив доступ по ssh, продемонстрировать что хост по ssh доступен а icmp нет
***
```
iptables -I INPUT -s 192.168.11.1 -j DROP
iptables -I INPUT -s 192.168.11.1 -p tcp --dport 22 -j ACCEPT
```
![dem2](dem2.PNG?raw=true)
***
3 Запретить только ssh , продемонстрировать что icmp работает
***
```
iptables -I INPUT -s 192.168.11.1 -p tcp --dport 22 -j DROP
```
![dem3](dem3.PNG?raw=true)
